### 1 如何检测内存泄漏

这是一个开放问题，可以使用JVisualVM可视化工具来检测。

1. 在JVisualVM中可以查看到运行在本地和远程的VM上的进程。
2. 使用Visual GC标签可以看到进程的堆使用情况。
3. 使用dump可以截取当时的堆内存转储快照。
4. 将不同时间的快照进行对比，可以查看到不同类的实例的数量改变情况，分析出可能发生内存泄漏的类。
5. 将类选择在实例视图中显示，可以显示此类有哪些实例，并且可以查看这些实例被哪些类引用，进而可以定位代码中何处发生了内存泄漏。



### 2 CPU 总是 100%，怎么定位问题，并且解决

1. 通过任务管理器查看哪个进程占用CPU较高，如果和JVM无关则关闭一些进程。
2. 使用JVisualVM，找到占用CPU最高的进程，再定位到运行时间最长的线程。
3. dump此线程，查看此线程卡在哪一步，查看代码是否发生了死循环。



### 3 CPU 时而 100%，内存经常 100%，怎么定位问题，并且解决

有可能发生了内存泄漏，见问题1。



