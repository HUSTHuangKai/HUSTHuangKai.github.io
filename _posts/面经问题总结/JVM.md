### 1 如何检测内存泄漏

这是一个开放问题，可以使用JVisualVM可视化工具来检测。

1. 在JVisualVM中可以查看到运行在本地和远程的VM上的进程。
2. 使用Visual GC标签可以看到进程的堆使用情况。
3. 使用dump可以截取当时的堆内存转储快照。
4. 将不同时间的快照进行对比，可以查看到不同类的实例的数量改变情况，分析出可能发生内存泄漏的类。
5. 将类选择在实例视图中显示，可以显示此类有哪些实例，并且可以查看这些实例被哪些类引用，进而可以定位代码中何处发生了内存泄漏。